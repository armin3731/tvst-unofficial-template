\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tvst}[Unofficial TVST Journal Template]

\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage[left=1.5cm, right=0.75cm, top=0.75cm, bottom=1in, marginparsep=0.5cm]{geometry}
\RequirePackage[sfdefault]{sourcesanspro} % Title/Header font
\RequirePackage{tgtermes}                % Body font (Times clone)
\RequirePackage{xcolor}
\RequirePackage{graphicx}
\RequirePackage{multicol}
\RequirePackage{background}
\RequirePackage{tikz}
\RequirePackage{titlesec}
\definecolor{tvstblue}{RGB}{0, 114, 188}
\RequirePackage{caption}
\RequirePackage{hyperref}
\RequirePackage[
  backend=biber,
  style=numeric-comp, % 'comp' compresses [1,2,3] to [1-3]
  sorting=none,
  autocite=superscript
]{biblatex}
% Vertical Sidebar logic
\backgroundsetup{
  scale=1, angle=90, opacity=1, color=tvstblue, 
  contents={
    \begin{tikzpicture}[remember picture, overlay]
      \node[anchor=west, xshift=-3.0cm, yshift=9.5cm] at (current page.west) 
      {\Large\sffamily \textbf{translational} vision science \& technology \rule[0.5ex]{17.5cm}{1pt}};
    \end{tikzpicture}
  }
}

% Custom commands for layout
\newcommand{\journalheader}{
    \hspace{-1.2em}{\Huge\sffamily\color{tvstblue} tvst}\\[-0.5ex]
    \textcolor{tvstblue}{\rule{\textwidth}{1.5pt}}\\[-0.2ex]
    \colorbox{tvstblue}{\color{white}\sffamily\bfseries\strut Cornea \& External Disease}\par\vspace{1em}
}

\newcommand{\papertitle}[1]{{\huge\sffamily\bfseries\raggedright #1\par}\vspace{1.5em}}
\newcommand{\authorlist}[1]{{\noindent\large\sffamily\bfseries #1\par}\vspace{1em}}
\newcommand{\affiliations}[1]{{\noindent\scriptsize\sffamily #1\par}\vspace{3em}}

\newcommand{\infosection}[2]{{\footnotesize\sffamily \textbf{#1:} #2\par}\vspace{0.5em}}

\newcommand{\sectionbox}[1]{%
    \vspace{1em}\noindent\colorbox{tvstblue}{\parbox[c][1.5em]{\linewidth}{\color{white}\Large\sffamily\bfseries\hspace{0.5em}#1}}\par\vspace{1em}
}

% Format for Subsections
\titleformat{\subsection}
  {\normalfont\sffamily\large\bfseries} % Font style: Sans Serif, Large, Bold
  {}                     % Label (e.g., 1.1)
  {1em}                                % Space between label and title
  {}                                   % Code preceding title body

% Format for Subsubsections
\titleformat{\subsubsection}
  {\normalfont\sffamily\normalsize\bfseries\itshape} % Font style: Sans, Bold, Italic
  {}                                % Label (e.g., 1.1.1)
  {1em}                                              % Space between label and title
  {}                                                 % Code preceding title body


\captionsetup{
  labelfont={sf,bf, color=tvstblue}, % Bold and Blue label
  textfont={sf,color=black},  % Italic black text
  font=large,              % Overall smaller font size
  justification=raggedright,     % Centers the caption
  singlelinecheck=false        % Forces centering even for short lines
}

\hypersetup{
  colorlinks=true,
  linkcolor=tvstblue,
  citecolor=tvstblue,
  urlcolor=tvstblue
}

\defbibheading{bibliography}[\refname]{%
  \sectionbox{#1} \vspace{-1.0em}
}

% \DeclareCiteCommand{\cite}[\mkbibsuperscript]
%   {\usebibmacro{prenote}}
%   {\usebibmacro{citeindex}%
%    \usebibmacro{cite}}
%   {\multicitedelim}
%   {\usebibmacro{postnote}}